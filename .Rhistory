install.packages("lubridate")
install.packages("dplyr")
install.packages("tidyr")
install.packages("ggplot2")
install.packages("lattice")
install.packages("ggvis")
install.packages("googleVis")
library(lubridate)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(lattice)
library(ggvis)
library(googleVis)
getfile <- tempfile()
download.file ("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip" , getfile)
ac = read.csv(unz(getfile, "activity.csv"))
unlink(getfile)
str(ac) ; head(ac)
ac$Date = as.Date(ac$date)
ac$date = NULL
```{r Meanperday, echo=TRUE}
ac_days = ac %>% group_by(Date) %>%
summarize( D_steps = sum(steps, na.rm=T))
mean(ac_days$D_steps)
```
ggplot(ac_days, aes(x=D_steps)) + geom_histogram(bindwidth=1 , colour="black", fill="orange" ,  position="identity") +
geom_vline(aes(xintercept=mean(D_steps, na.rm=T)),  color="black", linetype="dashed", size=1) +
geom_vline(aes(xintercept=median(D_steps, na.rm=T)),  color="blue", linetype="dashed", size=1) +
xlab("Steps Per Day") + ylab("Count") + ggtitle("Steps Histogram") +
theme_bw()
ggplot(ac_days, aes(x=D_steps)) + geom_histogram(bindwidth=1 , colour="black", fill="orange" ,  position="identity") +
geom_vline(aes(xintercept=mean(D_steps, na.rm=T)),  color="black", linetype="dashed", size=1) +
geom_vline(aes(xintercept=median(D_steps, na.rm=T)),  color="blue", linetype="dashed", size=1) +
xlab("Steps Per Day") + ylab("Count") + ggtitle("Steps Histogram") +
theme_bw()
mean(ac_days$D_steps)
median(ac_days$D_steps)
time = ac %>% select(interval, steps ) %>% group_by (interval) %>%
summarize( Avg_Steps = mean(steps , na.rm=T)) %>%
arrange(desc(interval))
time_p = gvisLineChart(time , xvar="interval", yvar="Avg_Steps",
options=list(title="          Plotted Intervals by Daily Average", legend="left",
titleTextStyle="{color:'black', fontSize:18}",
vAxis="{gridlines:{color:'black', count:3}}",
hAxis="{title:'Avg Steps', titleTextStyle:{color:'black'}}"
,series="[{color:'blue', targetAxisIndex: 0},
{color: 'black',targetAxisIndex:1}]",
vAxes="[{title:'Interval'},
{title:'Value 2 (\U00A3)'}]"
))
print(time_p, "chart")
time_p
print(time_p)
plot(time_p)
ac %>% select(interval, steps ) %>% group_by (interval) %>%
summarize( Avg_Steps = mean(steps , na.rm=T)) %>%
arrange(desc(interval)) %>%
ggvis( props( x= ~interval , y=~Avg_Steps)) + layer_line()
time = ac %>% select(interval, steps ) %>% group_by (interval) %>%
summarize( Avg_Steps = mean(steps , na.rm=T)) %>%
arrange(desc(interval))
ggvis( data=as.data.frame(time), props( x= ~interval , y=~Avg_Steps)) + layer_line()
ggplot(data=time, aes(x=interval, y=Avg_Steps )) +
geom_line( size=1) +
scale_colour_hue(name="Sex of payer", l=30)  +
scale_shape_manual(name="Sex of payer", values=c(22,21)) +
scale_linetype_discrete(name="Sex of payer") +
xlab("Time of day") + ylab("Total bill") + # Set axis labels
ggtitle("Average bill for 2 people") +  # Set title
theme_bw() +
theme(legend.position=c(.7, .4)) # Position legend inside
# This must go after theme_bw
ggplot(data=time, aes(x=interval, y=Avg_Steps , file="blue" )) +
geom_line( size=2) +
xlab("5 Minute Interval") + ylab("Average Steps Taken") +
ggtitle("Average Activity Pattern By Internal") +
theme_bw()
ggplot(data=time, aes(x=interval, y=Avg_Steps , file="blue" )) +
geom_line( size=1.2) +
xlab("5 Minute Interval") + ylab("Average Steps Taken") +
ggtitle("Average Activity Pattern By Internal") +
theme_bw()
Max_num = max(time$Avg_Steps)
Max_num
time %>% filter( Avg_Steps ==  Max_num ) %>% select(interval)
sum(is.na(ac))
ac2 = ac %>% select(Date, interval, steps) %>%
group_by(Date, interval) %>%
summarize( D_steps = sum(steps, na.rm=T)) %>%
select(D_steps, interval, Date) %>%
rename(steps=D_steps)
miss_val = merge(ac2, time , by ="interval", sort=F )
miss_val$Steps = ifelse( miss_val$steps == 0 , miss_val$Avg_Steps, miss_val$steps)
miss_val$steps = NULL ; miss_val$Avg_Steps = NULL;
head(miss_val) ; head(ac)
sum(is.na(miss_val))
newhist = miss_val %>% group_by(Date) %>%
summarize( D_steps = sum(Steps, na.rm=T))
ggvis( as.data.frame(newhist) , ~ D_steps , fill :="#FF9900") %>%
layer_histograms() %>%
add_axis("x", title="Counts", title_offset = 50) %>%
add_axis("y", title="Steps", title_offset = 50)
newhist = miss_val %>% group_by(Date) %>%
summarize( D_steps = sum(Steps, na.rm=T))
ggvis( as.data.frame(newhist) , ~ D_steps , fill :="#FF9900") %>%
layer_histograms() %>%
add_axis("x", title="Counts", title_offset = 50) %>%
add_axis("y", title="Steps", title_offset = 50)
ggvis( as.data.frame(newhist) , ~ D_steps , fill :="#FF9900") %>%
layer_histograms() %>%
add_axis("x", title="Steps", title_offset = 50) %>%
add_axis("y", title="Counts", title_offset = 50)
